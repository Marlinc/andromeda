include make/x86
include make/makeIncl

COMPRESSED= -D __COMPRESSED $(CFLAGS)
ASM = -S -masm=intel $(COMPRESSED)

x86: compressed
#	$(CC) -c */*.c -Iinclude $(CFLAGS)
#	$(MAKE) -C arch/x86 arch
#	$(LD) $(LDFLAGS) -o $(OUT) *.o

compressed:
#	$(CC) $(FLAGS) $(COMPRESSED) arch/x86/boot/compressed/*.c
	$(CC) $(FLAGS) $(COMPRESSED) arch/x86/mm/*.c -Iarch/x86/include
	$(CC) $(FLAGS) $(COMPRESSED) kern/*.c
	$(CC) $(FLAGS) $(COMPRESSED) vga/*.c
	$(CC) $(FLAGS) $(COMPRESSED) mm/*.c
	$(CC) $(FLAGS) $(COMPRESSED) error/*.c
	$(AS) arch/x86/boot/compressed/boot.s $(ASFLAGS) -o ./boot.o
	$(AS) arch/x86/mm/lgdt.s $(ASFLAGS) -o lgdt.o
	$(AS) arch/x86/interrupts/asm.s $(ASFLAGS) -o interruptHeaders.o
	$(LD) $(LDFLAGS) -o $(OUTC) *.o

asm:
	$(CC) $(FLAGS) $(ASM) arch/x86/mm/*.c -Iarch/x86/include
	$(CC) $(FLAGS) $(ASM) kern/*.c
	$(CC) $(FLAGS) $(ASM) vga/*.c
	$(CC) $(FLAGS) $(ASM) mm/*.c
	$(CC) $(FLAGS) $(ASM) error/*.c